language: node_js

services:
  - couchdb

node_js:
  - "stable"
sudo: false
addons:
  firefox: "44.0"
script: npm run $COMMAND
before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"

  - "export DEBUG=pouchdb:socket"
  - "npm install add-cors-to-couchdb"
  - "./node_modules/.bin/add-cors-to-couchdb"

env:
  matrix:
  - COMMAND=test
  - CLIENT=selenium:firefox:44.0 COMMAND=test

branches:
  only:
  - master
